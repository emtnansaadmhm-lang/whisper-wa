<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Whisper-WA | التحليل</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary-dark:#1f5f3b;
      --primary-mid:#3f9b5f;
      --primary-light:#5fbf7a;
      --accent-glow:#8fd9a8;

      --bg-dark:#0e1a12;

      --glass-bg: rgba(20, 40, 30, 0.65);
      --glass-border: rgba(95, 191, 122, 0.3);

      --text-white:#ffffff;
      --text-muted:#c2dec9;
    }

    *{ box-sizing:border-box; margin:0; padding:0; }

    body{
      font-family:'Tajawal',sans-serif;
      background-color: var(--bg-dark);
      color: var(--text-white);
      min-height:100vh;
      overflow-x:hidden;

      background-image:
        linear-gradient(rgba(31, 95, 59, 0.10) 1px, transparent 1px),
        linear-gradient(90deg, rgba(31, 95, 59, 0.10) 1px, transparent 1px);
      background-size: 40px 40px;
    }

    .animated-bg-logo{
      position: fixed;
      top:50%;
      left:50%;
      transform: translate(-50%,-50%);
      z-index:-1;
      width: 650px;
      pointer-events:none;
      opacity:0.18;
      animation: cyberGlowPulse 8s ease-in-out infinite alternate;
    }
    .animated-bg-logo img{
      width:100%;
      height:auto;
      filter: drop-shadow(0 0 30px var(--primary-mid));
    }
    @keyframes cyberGlowPulse{
      0%{ opacity:0.12; transform: translate(-50%,-50%) scale(0.95); }
      100%{ opacity:0.32; transform: translate(-50%,-50%) scale(1.05); }
    }

    .main-container{
      max-width: 1200px;
      margin: 0 auto;
      padding: 22px;
      display:flex;
      flex-direction:column;
      gap: 18px;
    }

    /* ===== Unified Top Header ===== */
    .topbar{
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(12px);
      border-radius: 18px;
      padding: 12px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 14px;
      flex-wrap: wrap;
      box-shadow: 0 6px 24px rgba(0,0,0,0.22);
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 260px;
    }
    .brand img{
      height: 42px;
      width:auto;
      filter: drop-shadow(0 0 6px rgba(63,155,95,0.5));
    }
    .brand .title{
      display:flex;
      flex-direction:column;
      line-height:1.1;
    }
    .brand .title b{ font-size:1.15rem; }
    .brand .title span{
      color: var(--text-muted);
      font-size:0.85rem;
      margin-top:4px;
    }

    .top-actions{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
      justify-content:flex-end;
    }

    .nav-link{
      text-decoration:none;
      color: var(--text-muted);
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid transparent;
      transition: 0.25s;
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-weight: 800;
      background: rgba(0,0,0,0.12);
    }
    .nav-link:hover{
      color: var(--accent-glow);
      border-color: rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.18);
      transform: translateY(-1px);
    }

    .lang-btn{
      background: rgba(95,191,122,0.12);
      border: 1px solid rgba(95,191,122,0.35);
      color: var(--accent-glow);
      padding: 9px 12px;
      border-radius: 999px;
      cursor:pointer;
      font-weight: 900;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition: 0.25s;
      user-select:none;
    }
    .lang-btn:hover{
      background: rgba(95,191,122,0.18);
      transform: translateY(-1px);
    }

    /* ===== Content Cards ===== */
    .grid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 16px;
    }
    .panel{
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(14px);
      border-radius: 18px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.25);
      padding: 16px;
      overflow:hidden;
    }

    .panel-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 12px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }
    .panel-title h4{
      font-size: 1rem;
      color: var(--primary-light);
      display:inline-flex;
      align-items:center;
      gap: 10px;
    }

    .muted{ color: var(--text-muted); font-size: 0.85rem; }

    .stat-grid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }
    @media(max-width: 980px){ .stat-grid{ grid-template-columns: repeat(2, 1fr);} }
    @media(max-width: 560px){ .stat-grid{ grid-template-columns: 1fr;} }

    .stat{
      background: rgba(0,0,0,0.18);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 14px;
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .stat .label{ color: var(--text-muted); font-size: 0.82rem; }
    .stat .value{ font-size: 1.25rem; font-weight: 700; }
    .stat .sub{ color: rgba(255,255,255,0.75); font-size: 0.82rem; }

    .list{
      display:flex;
      flex-direction:column;
      gap: 10px;
      max-height: 280px;
      overflow:auto;
      padding-left: 2px;
    }

    .item{
      background: rgba(0,0,0,0.18);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      padding: 10px 12px;
      display:flex;
      flex-direction:column;
      gap: 6px;
    }

    .item .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap: 6px;
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 0.78rem;
      border: 1px solid rgba(255,255,255,0.12);
      color: var(--accent-glow);
      background: rgba(95,191,122,0.12);
      white-space: nowrap;
    }
    .danger{ background: rgba(255, 77, 77, 0.12); color:#ffd0d0; border-color: rgba(255,77,77,0.25); }
    .warn{ background: rgba(255, 193, 7, 0.12); color:#ffe7a6; border-color: rgba(255,193,7,0.25); }
    .ok{ background: rgba(95,191,122,0.12); color:#d8ffe4; border-color: rgba(95,191,122,0.25); }

    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.85rem;
      color: rgba(255,255,255,0.88);
      overflow-wrap:anywhere;
    }

    .col-12{ grid-column: span 12; }
    .col-6{ grid-column: span 6; }
    @media(max-width: 980px){ .col-6{ grid-column: span 12; } }
  </style>
</head>

<body>
  <div class="animated-bg-logo">
    <img src="logo.png" alt="Background Logo">
  </div>

  <div class="main-container">

    <!-- ✅ Unified Header -->
    <header class="topbar">
      <div class="brand">
        <img src="logo.png" alt="Whisper-WA Logo">
        <div class="title">
          <b>Whisper-WA</b>
          <span id="top-subtitle">Digital Forensics Platform</span>
        </div>
      </div>

      <div class="top-actions">
        <button class="lang-btn" id="btnLang" type="button" title="Language">
          <span id="langText">AR</span> <i class="fa-solid fa-globe"></i>
        </button>

        <a class="nav-link" href="account.html" id="nav-account" title="Account">
          <i class="fa-solid fa-user"></i> <span id="txt-account">حسابي</span>
        </a>

        <a class="nav-link" href="reports.html" id="nav-reports" title="Reports">
          <i class="fa-solid fa-file-lines"></i> <span id="txt-reports">التقارير</span>
        </a>

        <a class="nav-link" href="chat.html" id="nav-chats" title="Chats">
          <i class="fa-solid fa-comments"></i> <span id="txt-chats">الشات</span>
        </a>

        <a class="nav-link" href="index.html" id="nav-home" title="Home">
          <i class="fa-solid fa-house"></i> <span id="txt-home">الرئيسية</span>
        </a>
      </div>
    </header>

    <div class="grid">

      <!-- Summary -->
      <section class="panel col-12">
        <div class="panel-title">
          <h4><i class="fa-solid fa-chart-simple"></i> <span id="txt-summary-title">ملخص عام</span></h4>
        </div>
        <div class="stat-grid" id="summaryStats"></div>
      </section>

      <!-- Activity -->
      <section class="panel col-6">
        <div class="panel-title">
          <h4><i class="fa-solid fa-clock"></i> <span id="txt-activity-title">نمط النشاط</span></h4>
        </div>
        <div class="list" id="activityList"></div>
      </section>

      <!-- Flags -->
      <section class="panel col-6">
        <div class="panel-title">
          <h4><i class="fa-solid fa-triangle-exclamation"></i> <span id="txt-flags-title">مؤشرات مبدئية</span></h4>
        </div>
        <div class="list" id="flagsList"></div>
      </section>

      <!-- URLs -->
      <section class="panel col-6">
        <div class="panel-title">
          <h4><i class="fa-solid fa-link"></i> <span id="txt-urls-title">الروابط المستخرجة</span></h4>
          <span class="pill" id="urlsCountPill">0</span>
        </div>
        <div class="list" id="urlsList"></div>
      </section>

      <!-- Numbers -->
      <section class="panel col-6">
        <div class="panel-title">
          <h4><i class="fa-solid fa-hashtag"></i> <span id="txt-numbers-title">الأرقام المستخرجة</span></h4>
          <span class="pill" id="numbersCountPill">0</span>
        </div>
        <div class="list" id="numbersList"></div>
      </section>

      <!-- Keywords -->
      <section class="panel col-12">
        <div class="panel-title">
          <h4><i class="fa-solid fa-magnifying-glass"></i> <span id="txt-keywords-title">كلمات مهمة</span></h4>
          <span class="muted" id="txt-keywords-note">Hits</span>
        </div>
        <div class="list" id="keywordsList"></div>
      </section>

    </div>
  </div>

  <script>
    // =========================
    // ✅ Language + UI Text
    // =========================
    let currentLang = "ar";

    const UI = {
      ar: {
        title: "Whisper-WA | التحليل",
        topSubtitle: "منصة التحليل الجنائي الرقمي",
        nav: { home:"الرئيسية", chats:"الشات", reports:"التقارير", account:"حسابي" },

        summaryTitle: "ملخص عام",
        activityTitle: "نمط النشاط",
        flagsTitle: "مؤشرات مبدئية",
        urlsTitle: "الروابط المستخرجة",
        numbersTitle: "الأرقام المستخرجة",
        keywordsTitle: "كلمات مهمة",
        keywordsNote: "Hits",

        // Summary labels
        s_total: "عدد الرسائل",
        s_first: "أول تواصل",
        s_last: "آخر تواصل",
        s_artifacts: "Artifacts",
        s_sent: "مرسل",
        s_recv: "مستلم",

        // Pills/units
        times: "مرة",
        links: "روابط",
        numbers: "أرقام",
        hits: "Hits",

        // Activity labels
        a_peak_hour: "أكثر ساعة نشاط",
        a_peak_day: "أكثر يوم نشاط",
        a_duration: "مدة التواصل",
        a_ratio: "نسبة مرسل/مستلم",

        // Flags pill text
        p_important: "مهم",
        p_warn: "تنبيه",
        p_ok: "مقبول"
      },

      en: {
        title: "Whisper-WA | Analysis",
        topSubtitle: "Digital Forensics Platform",
        nav: { home:"Home", chats:"Chats", reports:"Reports", account:"Account" },

        summaryTitle: "Overview",
        activityTitle: "Activity Pattern",
        flagsTitle: "Initial Flags",
        urlsTitle: "Extracted URLs",
        numbersTitle: "Extracted Numbers",
        keywordsTitle: "Important Keywords",
        keywordsNote: "Hits",

        // Summary labels
        s_total: "Total Messages",
        s_first: "First Contact",
        s_last: "Last Contact",
        s_artifacts: "Artifacts",
        s_sent: "Sent",
        s_recv: "Received",

        // Pills/units
        times: "times",
        links: "URLs",
        numbers: "Numbers",
        hits: "Hits",

        // Activity labels
        a_peak_hour: "Most active hour",
        a_peak_day: "Most active day",
        a_duration: "Communication span",
        a_ratio: "Sent / Received ratio",

        // Flags pill text
        p_important: "Important",
        p_warn: "Warning",
        p_ok: "OK"
      }
    };

    // =========================
    // ✅ Demo Raw Data (language-neutral)
    // =========================
    const raw = {
      summary: {
        total_messages: 342,
        sent: 180,
        received: 162,
        first_contact: "2026-02-01 09:20",
        last_contact: "2026-02-12 23:10",
        urls_count: 12,
        numbers_count: 6,
        keyword_hits_total: 9
      },
      activity: [
        { id:"peak_hour", value_ar:"11:00 مساءً", value_en:"11:00 PM" },
        { id:"peak_day", value_ar:"2026-02-12", value_en:"2026-02-12" },
        { id:"duration", value_ar:"12 يوم", value_en:"12 days" },
        { id:"ratio", value_ar:"52% / 48%", value_en:"52% / 48%" }
      ],
      flags: [
        {
          level:"warn",
          title_ar:"وجود روابط مختصرة",
          title_en:"Shortened links detected",
          desc_ar:"تم رصد روابط قصيرة (مثل bit.ly) تحتاج تحقق.",
          desc_en:"Short URLs (e.g., bit.ly) were detected and need verification."
        },
        {
          level:"danger",
          title_ar:"كلمات مرتبطة بالتحويل/التحقق",
          title_en:"Transfer/verification keywords",
          desc_ar:"تم رصد كلمات مثل: OTP، تحويل، كود.",
          desc_en:"Keywords found such as: OTP, transfer, code."
        },
        {
          level:"ok",
          title_ar:"تسلسل زمني واضح",
          title_en:"Clear timeline",
          desc_ar:"الرسائل مرتبة بزمنها بدون فجوات كبيرة في هذا الديمو.",
          desc_en:"Messages appear chronological with no large gaps in this demo."
        }
      ],
      urls: [
        { url:"https://bit.ly/3xxxx", count:4 },
        { url:"https://t.me/example", count:3 },
        { url:"https://example.com/login", count:2 },
        { url:"https://maps.app.goo.gl/xxxxx", count:1 }
      ],
      numbers: [
        { value:"0501234567", context_ar:"رقم مذكور داخل رسالة", context_en:"Number mentioned in a message", count:2 },
        { value:"SA0000000000000000000000", context_ar:"شكل IBAN (تجريبي)", context_en:"IBAN-like pattern (demo)", count:1 },
        { value:"123456", context_ar:"كود/OTP محتمل", context_en:"Possible code/OTP", count:3 }
      ],
      keywords: [
        { keyword:"OTP", hits:3, examples_ar:["أرسل OTP بسرعة","لا تعطي OTP لأحد"], examples_en:["Send the OTP quickly","Never share OTP with anyone"] },
        { keyword:"Transfer", hits:2, examples_ar:["حول المبلغ","تم التحويل"], examples_en:["Transfer the amount","Transfer completed"] },
        { keyword:"Bank", hits:1, examples_ar:["من البنك اتصلوا"], examples_en:["They called from the bank"] },
        { keyword:"Code", hits:3, examples_ar:["أرسل الكود","الكود وصل"], examples_en:["Send the code","The code arrived"] }
      ]
    };

    // =========================
    // ✅ Render helpers (use currentLang everywhere)
    // =========================
    function setPill(el, text){ el.textContent = text; }

    function renderSummary(s){
      const t = UI[currentLang];
      const wrap = document.getElementById("summaryStats");
      wrap.innerHTML = "";

      const cards = [
        {
          label: t.s_total,
          value: s.total_messages,
          sub: `${t.s_sent}: ${s.sent} | ${t.s_recv}: ${s.received}`
        },
        {
          label: t.s_first,
          value: s.first_contact.split(" ")[0],
          sub: s.first_contact
        },
        {
          label: t.s_last,
          value: s.last_contact.split(" ")[0],
          sub: s.last_contact
        },
        {
          label: t.s_artifacts,
          value: `${s.urls_count} ${t.links}`,
          sub: `${s.numbers_count} ${t.numbers} | ${s.keyword_hits_total} ${t.hits}`
        }
      ];

      cards.forEach(c=>{
        const div = document.createElement("div");
        div.className = "stat";
        div.innerHTML = `
          <div class="label">${c.label}</div>
          <div class="value">${c.value}</div>
          <div class="sub">${c.sub}</div>
        `;
        wrap.appendChild(div);
      });
    }

    function renderActivity(list){
      const t = UI[currentLang];
      const wrap = document.getElementById("activityList");
      wrap.innerHTML = "";

      const labelMap = {
        peak_hour: t.a_peak_hour,
        peak_day: t.a_peak_day,
        duration: t.a_duration,
        ratio: t.a_ratio
      };

      list.forEach(r=>{
        const div = document.createElement("div");
        div.className = "item";
        const val = (currentLang === "ar") ? r.value_ar : r.value_en;
        div.innerHTML = `
          <div class="row">
            <span class="mono">${labelMap[r.id] || r.id}</span>
            <span class="pill ok">${val}</span>
          </div>
        `;
        wrap.appendChild(div);
      });
    }

    function renderFlags(flags){
      const t = UI[currentLang];
      const wrap = document.getElementById("flagsList");
      wrap.innerHTML = "";

      flags.forEach(f=>{
        const div = document.createElement("div");
        div.className = "item";

        const pillClass = f.level === "danger" ? "danger" : (f.level === "warn" ? "warn" : "ok");
        const pillText = f.level === "danger" ? t.p_important : (f.level === "warn" ? t.p_warn : t.p_ok);

        const title = (currentLang === "ar") ? f.title_ar : f.title_en;
        const desc  = (currentLang === "ar") ? f.desc_ar  : f.desc_en;

        div.innerHTML = `
          <div class="row">
            <span class="mono"><b>${title}</b></span>
            <span class="pill ${pillClass}">${pillText}</span>
          </div>
          <div class="muted">${desc}</div>
        `;
        wrap.appendChild(div);
      });
    }

    function renderUrls(urls){
      const t = UI[currentLang];
      const wrap = document.getElementById("urlsList");
      wrap.innerHTML = "";

      setPill(document.getElementById("urlsCountPill"), `${urls.length} ${t.links}`);

      if(!urls.length){
        wrap.innerHTML = `<div class="muted">${currentLang==="ar" ? "لا توجد روابط." : "No URLs found."}</div>`;
        return;
      }

      urls.forEach(u=>{
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <div class="row">
            <span class="mono">${u.url}</span>
            <span class="pill">${u.count} ${t.times}</span>
          </div>
        `;
        wrap.appendChild(div);
      });
    }

    function renderNumbers(nums){
      const t = UI[currentLang];
      const wrap = document.getElementById("numbersList");
      wrap.innerHTML = "";

      setPill(document.getElementById("numbersCountPill"), `${nums.length} ${t.numbers}`);

      if(!nums.length){
        wrap.innerHTML = `<div class="muted">${currentLang==="ar" ? "لا توجد أرقام." : "No numbers found."}</div>`;
        return;
      }

      nums.forEach(n=>{
        const div = document.createElement("div");
        div.className = "item";
        const ctx = (currentLang==="ar") ? n.context_ar : n.context_en;
        div.innerHTML = `
          <div class="row">
            <span class="mono">${n.value}</span>
            <span class="pill">${n.count} ${t.times}</span>
          </div>
          <div class="muted">${ctx}</div>
        `;
        wrap.appendChild(div);
      });
    }

    function renderKeywords(keys){
      const t = UI[currentLang];
      const wrap = document.getElementById("keywordsList");
      wrap.innerHTML = "";

      keys.forEach(k=>{
        const div = document.createElement("div");
        div.className = "item";
        const examples = (currentLang==="ar" ? (k.examples_ar||[]) : (k.examples_en||[]))
          .slice(0,3).map(x => `• ${x}`).join("<br>");

        div.innerHTML = `
          <div class="row">
            <span class="mono"><b>${k.keyword}</b></span>
            <span class="pill">${k.hits} ${t.hits}</span>
          </div>
          <div class="muted">${examples || "—"}</div>
        `;
        wrap.appendChild(div);
      });
    }

    function renderAll(){
      renderSummary(raw.summary);
      renderActivity(raw.activity);
      renderFlags(raw.flags);
      renderUrls(raw.urls);
      renderNumbers(raw.numbers);
      renderKeywords(raw.keywords);
    }

    // =========================
    // ✅ Apply language to ALL UI + rerender content
    // =========================
    function applyLang(){
      const t = UI[currentLang];
      const html = document.documentElement;

      html.lang = currentLang;
      html.dir  = (currentLang === "ar") ? "rtl" : "ltr";

      document.title = t.title;

      document.getElementById("top-subtitle").textContent = t.topSubtitle;

      document.getElementById("txt-home").textContent = t.nav.home;
      document.getElementById("txt-chats").textContent = t.nav.chats;
      document.getElementById("txt-reports").textContent = t.nav.reports;
      document.getElementById("txt-account").textContent = t.nav.account;

      document.getElementById("txt-summary-title").textContent = t.summaryTitle;
      document.getElementById("txt-activity-title").textContent = t.activityTitle;
      document.getElementById("txt-flags-title").textContent = t.flagsTitle;
      document.getElementById("txt-urls-title").textContent = t.urlsTitle;
      document.getElementById("txt-numbers-title").textContent = t.numbersTitle;
      document.getElementById("txt-keywords-title").textContent = t.keywordsTitle;
      document.getElementById("txt-keywords-note").textContent = t.keywordsNote;

      // Button shows opposite label like your other pages
      document.getElementById("langText").textContent = (currentLang === "en") ? "AR" : "EN";

      // ✅ IMPORTANT: rerender everything inside cards
      renderAll();
    }

    // Language button
    document.getElementById("btnLang").addEventListener("click", ()=>{
      currentLang = (currentLang === "ar") ? "en" : "ar";
      applyLang();
    });

    // Init
    applyLang();
  </script>
</body>
</html>
